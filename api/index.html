

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cams/">
      
      
        <link rel="next" href="../assistants/">
      
      
        
      
      
      <link rel="icon" href="../img/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Работа с API - AI in robotics</title>
      
    
    

      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
<link rel="stylesheet" type="text/css" href="../css/fonts.css" />
<link rel="stylesheet" type="text/css" href="../css/style.css" />

    
      
    
    
      
    
    
      <link rel="stylesheet" href="../css/tabs.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    

<script type="text/javascript">
    if ( window !== window.parent ) {
        // The page is in an iframe
        window.addEventListener("DOMContentLoaded", function externalLinks() {
            var anchors = document.getElementsByTagName("a");
            for (var i = 0; i < anchors.length; i++) {
                    if (anchors[i].hostname !== window.location.hostname) {
                        anchors[i].setAttribute("target", "_blank");
                        anchors[i].setAttribute("rel", "noopener");
                    }
                    // Handle 'Open in SWAN' badges in the parent JupyterLab window
                    if (anchors[i].hostname == 'cern.ch' && anchors[i].pathname == '/swanserver/cgi-bin/go') {
                        const projectUrl = new URLSearchParams(anchors[i].search).get('projurl');
                        if (projectUrl) {
                                anchors[i].onclick = () => {
                                window.parent.postMessage(projectUrl,'*');
                                //  Skip redirecting the iframe page to the link 
                                return false;
                            }
                        }
                    }
            }
        }); 
    }
</script>

  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AI in robotics" class="md-header__button md-logo" aria-label="AI in robotics" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI in robotics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Работа с API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AI in robotics" class="md-nav__button md-logo" aria-label="AI in robotics" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    AI in robotics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Введение
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pycharm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Работа в PyCharm
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Способы внедрения
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Способы внедрения
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Подходы к внедрению
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tgai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Telegram Bot + AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Фреймфорки
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Фреймфорки
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../yolo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YOLO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mediapipe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MediaPipe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Технологии
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Технологии
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../face_recognition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Распознавание лица
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speech-to-text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Распознавание речи
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Синтез речи
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KWS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Распознавание ключевых слов
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Большие языковые модели
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hardware
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hardware
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../py%2Bard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python + Arduino
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jetson/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jetson Nano
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raspberry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Raspberry Pi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kinect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    XBOX Kinect
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ИИ камеры
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Работа с API
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Работа с API
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api-" class="md-nav__link">
    <span class="md-ellipsis">
      
        Использование API-ключа
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stability-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stability Ai
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stability Ai">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openrouter" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenRouter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenRouter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#groq" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groq
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Groq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openai" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenAI
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenAI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../assistants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ИИ помощники
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../todo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    На будущее
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocktest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Тестовая страница
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api-" class="md-nav__link">
    <span class="md-ellipsis">
      
        Использование API-ключа
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stability-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stability Ai
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stability Ai">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openrouter" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenRouter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenRouter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#groq" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groq
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Groq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openai" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenAI
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenAI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api">API</h1>
<p><strong>API (Application Programming Interface)</strong> — это набор правил, по которым одна программа говорит другой:</p>
<ul>
<li>что можно спросить</li>
<li>в каком формате</li>
<li>что придёт в ответ</li>
<li>и что будет, если ты накосячишь</li>
</ul>
<p>API - часто, но не всегда требуют оплату для работы, с лимитами по количеству токенов или других единиц.  </p>
<p><strong>API-ключ</strong> — это уникальная строка, по которой сервис понимает, кто ты, что тебе можно, и сколько ты уже совершил запросов.   </p>
<h2 id="api-">Использование API-ключа</h2>
<p>API-ключ — это по сути пароль к сервису. Если ключ утёк — платить будешь ты. Сервису вообще всё равно, кто именно сделал запрос. По этой причине нужно защищать свой ключ. Все API сервисы имеют панели для наблюдения за трафиком использования. При подозрительной активности можно удалить ключ и создать новый.   </p>
<p><strong>Нельзя:</strong>
- Хардкодить ключ в код, как в примерах ниже
- Прописывать ключ в frontend
- Отправлять ключ в публичные репозитории, например в GitHub
- Использовать один ключ на всё и навсегда
- Передавать ключ другим людям</p>
<p><strong>Нужно:</strong>
- Хранить ключ через переменные окружения
- Через .env файл (с игнором в git)
- Использовать отдельные ключи под разные проекты</p>
<details>
<summary>Добавление API ключа как переменную окружения</summary>

Windows:
<div class="highlight"><pre><span></span><code>setx OPENAI_API_KEY &quot;sk-XXXXXXXXXXXXXXXX&quot;
</code></pre></div>
Linux:
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">OPENAI_API_KEY</span><span class="o">=</span><span class="s2">&quot;sk-XXXXXXXXXXXXXXXX&quot;</span>
</code></pre></div>
Чтение ключа в python:
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span>
</code></pre></div>
</details>

<details>
<summary>Использование .env файла</summary>

В папке с проектом / кодом создается файл .env   
В файл .gitignore добавляется .env (чтобы файл не попал на GitHub).

Нужна библиотека:

<div class="highlight"><pre><span></span><code>pip install python-dotenv
</code></pre></div>

Чтение ключа в python:
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">load_dotenv</span><span class="p">()</span>  <span class="c1"># читает .env и кладёт всё в окружение</span>

<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span>
</code></pre></div>
</details>

<h2 id="stability-ai">Stability Ai</h2>
<p><strong>Stability AI</strong> — это компания, которая разрабатывает и поддерживает открытые генеративные модели ИИ, в первую очередь для создания изображений, а также текста, аудио и видео.<br />
<a href="https://platform.stability.ai/">https://platform.stability.ai/</a> <br />
<a href="https://platform.stability.ai/docs/api-reference">https://platform.stability.ai/docs/api-reference</a></p>
<h3 id="_1">Пример</h3>
<p>Код берёт текст, отправляет его в Stability AI и сохраняет сгенерированную картинку на диск. Модель stable-diffusion-xl-1024-v1-0.</p>
<details>
<summary>Требования</summary>
python 3.12
<div class="highlight"><pre><span></span><code>pip install request
</code></pre></div>
</details>

<details>
<summary>Код</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>


<span class="k">def</span><span class="w"> </span><span class="nf">stability_txt2img</span><span class="p">(</span>
    <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;stability.png&quot;</span><span class="p">,</span>
    <span class="n">engine_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;stable-diffusion-xl-1024-v1-0&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">cfg_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.0</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">style_preset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">negative_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>

    <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;STABILITY_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">api_key</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing STABILITY_API_KEY env var.&quot;</span><span class="p">)</span>

    <span class="n">api_host</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;https://api.stability.ai&quot;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_host</span><span class="si">}</span><span class="s2">/v1/generation/</span><span class="si">{</span><span class="n">engine_id</span><span class="si">}</span><span class="s2">/text-to-image&quot;</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">text_prompts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}]</span>
    <span class="k">if</span> <span class="n">negative_prompt</span><span class="p">:</span>
        <span class="n">text_prompts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">negative_prompt</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">})</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="n">steps</span><span class="p">,</span>
        <span class="s2">&quot;cfg_scale&quot;</span><span class="p">:</span> <span class="n">cfg_scale</span><span class="p">,</span>
        <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
        <span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="n">samples</span><span class="p">,</span>
        <span class="s2">&quot;text_prompts&quot;</span><span class="p">:</span> <span class="n">text_prompts</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">style_preset</span><span class="p">:</span>
        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;style_preset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style_preset</span>

    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTTP </span><span class="si">{</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">artifacts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;artifacts&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">artifacts</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No artifacts returned. Response: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="n">saved_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_path</span><span class="p">)</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span> <span class="ow">or</span> <span class="s2">&quot;.png&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">art</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">artifacts</span><span class="p">):</span>
        <span class="n">finish</span> <span class="o">=</span> <span class="n">art</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;finishReason&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">finish</span> <span class="o">!=</span> <span class="s2">&quot;SUCCESS&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generation failed/filtered: finishReason=</span><span class="si">{</span><span class="n">finish</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">b64</span> <span class="o">=</span> <span class="n">art</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base64&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b64</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing base64 field in artifact: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">art</span><span class="p">))</span>

        <span class="n">img_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="si">}{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img_bytes</span><span class="p">)</span>
        <span class="n">saved_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">saved_paths</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="n">stability_txt2img</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;A small cozy robotics lab, cinematic lighting, ultra detailed&quot;</span><span class="p">,</span>
        <span class="n">out_path</span><span class="o">=</span><span class="s2">&quot;robot_lab.png&quot;</span><span class="p">,</span>
        <span class="n">samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">style_preset</span><span class="o">=</span><span class="s2">&quot;cinematic&quot;</span><span class="p">,</span>
        <span class="n">negative_prompt</span><span class="o">=</span><span class="s2">&quot;blurry, lowres, watermark, text&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved:&quot;</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
</code></pre></div>

</details>

<details>
<summary>Пример выходного изображения</summary>
<img src="../img/robot_lab.png" alt="desc" width="500">   
</details>

<h2 id="openrouter">OpenRouter</h2>
<p><strong>OpenRouter</strong> — это агрегатор API для больших языковых моделей. Проще: единая точка входа к куче разных LLM от разных провайдеров, через один и тот же HTTP-API.<br />
<a href="https://openrouter.ai/">https://openrouter.ai/</a></p>
<p>OpenRouter позволяет:</p>
<ul>
<li>вызывать модели разных компаний (OpenAI, Anthropic, Meta, Mistral, Google и т.д.)</li>
<li>использовать один формат запросов, не переписывая код под каждый сервис</li>
<li>выбирать модель по имени</li>
<li>автоматически маршрутизировать запросы между провайдерами (отсюда и название)</li>
</ul>
<h3 id="_2">Пример</h3>
<p>Код читает текстовый промпт из терминала, отправляет его в OpenRouter с ключом и выводит ответ языковой модели <strong>meta-llama/llama-3.1-8b-instruct</strong> обратно в терминал.</p>
<details>
<summary>Требования</summary>
python 3.12
<div class="highlight"><pre><span></span><code>pip install request
</code></pre></div>
</details>

<details>
<summary>Код</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="n">API_URL</span> <span class="o">=</span> <span class="s2">&quot;https://openrouter.ai/api/v1/chat/completions&quot;</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENROUTER_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sk-or-v1-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">API_KEY</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;OPENROUTER_API_KEY not set&quot;</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">API_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;meta-llama/llama-3.1-8b-instruct&quot;</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You: &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">):</span>
        <span class="k">break</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
        <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">user_input</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">API_URL</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;choices&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">LLaMA:&quot;</span><span class="p">,</span> <span class="n">reply</span><span class="p">)</span>
</code></pre></div>

</details>

<details>
<summary>Пример выходного текста</summary>

<div class="highlight"><pre><span></span><code>You: Who is Kanye West?

LLaMA: Kanye West is a multi-talented American artist, entrepreneur, and cultural icon. Born on June 8, 1977, in Atlanta, Georgia, West rose to fame in the early 2000s as a rapper, producer, and fashion designer. Here&#39;s a brief overview of his life and career:

<span class="gs">**Early Life and Career**</span>

West grew up in a middle-class family in Chicago, Illinois. He developed an interest in music at a young age and began producing tracks in his teenage years. After dropping out of college, West moved to Chicago and began working as a producer for local artists. His big break came in 2002 when he produced Jay-Z&#39;s hit single &quot;Izzo (H.O.V.A.).&quot;

<span class="gs">**Rise to Fame**</span>

West&#39;s debut album, &quot;The College Dropout,&quot; was released in 2004 to critical acclaim. The album&#39;s unique blend of hip-hop, soul, and electronic music, combined with West&#39;s innovative production style and introspective lyrics, made him an overnight sensation. The album spawned hit singles like &quot;Through the Wire&quot; and &quot;Jesus Walks.&quot;

<span class="gs">**Success and Experimentation**</span>

West&#39;s subsequent albums, &quot;Late Registration&quot; (2005) and &quot;Graduation&quot; (2007), solidified his position as a leading figure in hip-hop. He experimented with new sounds, collaborating with artists like Justin Vernon (Bon Iver), Kid Cudi, and Lil Wayne. West&#39;s music often addressed themes of social justice, celebrity culture, and personal struggle.

<span class="gs">**Fashion and Entrepreneurship**</span>

In addition to music, West has made a significant impact in the fashion world. He launched his fashion brand, Yeezy, in 2015, which has become a global phenomenon. West has collaborated with Adidas, Nike, and Louis Vuitton, and has been credited with popularizing the &quot;sneaker culture&quot; movement.

<span class="gs">**Controversies and Criticisms**</span>

West has been involved in numerous controversies throughout his career, including:

<span class="k">1.</span> <span class="gs">**Taylor Swift VMA Incident (2009)**</span>: West stormed the stage at the MTV Video Music Awards, interrupting Taylor Swift&#39;s acceptance speech.
<span class="k">2.</span> <span class="gs">**Racism and Antisemitism Accusations**</span>: West has faced criticism for his comments on racism and antisemitism, including his 2018 statement, &quot;I love Hitler,&quot; which sparked widespread outrage.
<span class="k">3.</span> <span class="gs">**Mental Health and Divorce**</span>: West has been open about his struggles with mental health and has been involved in high-profile divorces, including his split from Kim Kardashian.

<span class="gs">**Impact and Legacy**</span>

Kanye West is widely regarded as one of the most influential artists of the 21st century. His innovative production style, lyrical honesty, and unapologetic attitude have inspired a generation of musicians, fashion designers, and entrepreneurs. Love him or hate him, Kanye West is a cultural icon who continues to shape the music, fashion, and entertainment industries.

How&#39;s that for a brief introduction? Do you have any specific questions about Kanye West?
</code></pre></div>

</details>

<h2 id="groq">Groq</h2>
<p><strong>Groq</strong> — это компания, которая делает специализированные процессоры для ИИ и сервис, где можно очень быстро запускать LLM-модели (типа LLaMA, Mixtral и т.п.).<br />
<a href="https://groq.com/">https://groq.com/</a> <br />
<a href="https://console.groq.com/playground">https://console.groq.com/playground</a></p>
<p><strong>Groq API</strong> — это сервис для запуска LLM-моделей через HTTP, почти один в один как OpenAI API, но:</p>
<ul>
<li>очень низкая задержка</li>
<li>очень высокая скорость генерации</li>
<li>часто бесплатно или почти бесплатно</li>
<li>без обучения моделей, только инференс</li>
</ul>
<h3 id="_3">Пример</h3>
<p>Код читает текстовый промпт из терминала, отправляет его в Groq API с ключом и выводит ответ языковой модели <strong>llama-3.1-8b-instant</strong> обратно в терминал.</p>
<details>
<summary>Требования</summary>

python 3.12
<div class="highlight"><pre><span></span><code>pip install groq
</code></pre></div>
</details>

<details>
<summary>Код</summary>

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">groq</span><span class="w"> </span><span class="kn">import</span> <span class="n">Groq</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Groq</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;gsk_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Groq CLI (hardcoded key edition). Ctrl+C to exit.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;You: &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prompt</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">continue</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="s2">&quot;llama-3.1-8b-instant&quot;</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="n">temperature</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
            <span class="n">max_tokens</span><span class="o">=</span><span class="mi">500</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;Groq: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">bye&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</code></pre></div>
</details>

<details>
<summary>Пример выходного текста</summary>

<div class="highlight"><pre><span></span><code>You: Who is Eminem?

Groq: Eminem, whose real name is Marshall Bruce Mathers III, is an American rapper, songwriter, record producer, and actor. He is one of the most successful and influential rappers of all time.

Born on October 17, 1972, in St. Joseph, Missouri, Eminem grew up in a low-income household in Warren, Michigan. He began rapping at a young age and formed his first group, D12, in the late 1990s.

Eminem&#39;s music career took off in the late 1990s with the release of his major-label debut album, &quot;The Slim Shady LP,&quot; in 1999. The album was a massive commercial success, thanks in part to the hit single &quot;My Name Is.&quot; The album&#39;s success was followed by &quot;The Marshall Mathers LP&quot; in 2000, which is often cited as one of the greatest hip-hop albums of all time.

Eminem&#39;s subsequent albums, including &quot;The Eminem Show&quot; (2002), &quot;Encore&quot; (2004), and &quot;Relapse&quot; (2009), solidified his position as a hip-hop icon. He has won 15 Grammy Awards and has been named one of the greatest rappers of all time by various publications, including Rolling Stone and Billboard.

Eminem is known for his provocative and often dark lyrics, which frequently incorporate humor, satire, and social commentary. He has been praised for his technical skill and lyrical complexity, as well as his ability to push the boundaries of what is considered acceptable in popular music.

Throughout his career, Eminem has been involved in several high-profile feuds with other rappers, including Insane Clown Posse, Ja Rule, and Machine Gun Kelly. He has also been open about his struggles with addiction and mental health, which have been reflected in his music.

In addition to his music career, Eminem has also acted in several films, including &quot;8 Mile&quot; (2002), which was loosely based on his own life experiences. He has also made appearances in TV shows and documentaries, including &quot;South Park&quot; and &quot;The Up in Smoke Tour.&quot;

Overall, Eminem is a highly influential and successful rapper who has left an indelible mark on the music industry. His music continues to be widely popular and influential, and he remains one of the most recognizable and respected figures in hip-hop.
</code></pre></div>
</details>

<h2 id="openai">OpenAI</h2>
<p><strong>OpenAI</strong> — это компания, занимающаяся исследованием и разработкой искусственного интеллекта, которая создала большие языковые модели (GPT‑3.5, GPT‑4, GPT‑4o), генерацию изображений (DALL·E) и модели для анализа и генерации аудио (Whisper, TTS). Она предоставляет <strong>API</strong> для доступа к этим моделям через HTTP.<br />
<a href="https://openai.com/">https://openai.com/</a><br />
<a href="https://platform.openai.com/docs/api-reference">https://platform.openai.com/docs/api-reference</a>  </p>
<p><strong>OpenAI API</strong> - не имеет бесплатных тарифов / токенов / запросов, всё только после покупки кредитов.</p>
<h3 id="_4">Пример</h3>
<p>Код ниже читает текстовый промпт из терминала, отправляет его в API OpenAI с ключом и выводит ответ языковой модели <strong>gpt‑4o</strong> обратно в терминал.</p>
<details>
<summary>Требования</summary>

python 3.12

<div class="highlight"><pre><span></span><code>pip install openai
</code></pre></div>
</details>

<details>
<summary>Код</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openai</span>

<span class="k">def</span><span class="w"> </span><span class="nf">chat</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gpt-4o&quot;</span><span class="p">,</span>
         <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">api_key</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing OPENAI_API_KEY env var.&quot;</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}],</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OpenAI CLI. Type &#39;exit&#39; to quit.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;You: &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ChatGPT:&quot;</span><span class="p">,</span> <span class="n">reply</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

</details>

<details>
<summary>Пример выходного текста</summary>

<div class="highlight"><pre><span></span><code>You: Who is Ada Lovelace?

ChatGPT: Ada Lovelace (1815–1852) was an English mathematician and writer who is often regarded as one of the world&#39;s first computer programmers. She worked with Charles Babbage on his proposed mechanical general-purpose computer, the Analytical Engine. Lovelace recognized that the machine could go beyond mere number‑crunching to perform more complex tasks, and she wrote a set of notes, including an algorithm for computing Bernoulli numbers, which many historians consider the first published computer program. Her vision of machines manipulating symbols and creating music or art foreshadowed modern computing, and she has become an important figure in the history of technology.
</code></pre></div>

</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class=" text">
    <p>SWAN © Copyright CERN 2016-2025. All rights reserved.</p>
    <ul>
        <li><a target="_blank" href="https://cern.ch/swan/">Home</a></li>
        <li><a target="_blank" href="https://cern.ch/swan-community/">Community</a></li>
        <li><a target="_blank" href="https://cern.service-now.com/service-portal/?id=functional_element&name=swan">Support</a></li>
        <li><a target="_blank" href="https://github.com/swan-cern">Github</a></li>
    </ul>
    <p class="poweredby">Powered by <strong><a href="https://www.mkdocs.org">MkDocs</a></strong> and <strong><a href="https://squidfunk.github.io/mkdocs-material/"> Material for MkDocs</a></strong></p>
</div>
<div class="md-layout-grid--align-right logo">
    <img src="../images/logo_cern.png" alt="CERN">
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>